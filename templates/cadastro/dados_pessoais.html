{% extends "base.html" %}

{% block title %}Dados Pessoais{% endblock %}

{% block content %}
<h2>Dados Pessoais</h2>
<form action="/dados_pessoais" method="POST" class="dados-pessoais-form">
    <!-- Nome Completo -->
    <div class="form-group">
        <label for="full_name">Nome Completo</label>
        <input type="text" id="full_name" name="full_name" placeholder="Nome Completo" value="{{ full_name or '' }}" required>
    </div>

    <!-- Email -->
    <div class="form-group">
        <label for="email">Email</label>
        <input type="email" id="email" name="email" placeholder="Email" value="{{ email or '' }}" required>
    </div>

    <!-- Telefone -->
    <div class="form-group">
        <label for="telefone">Telefone</label>
        <input type="text" id="telefone" name="telefone" placeholder="Telefone" value="{{ telefone or '' }}" required>
    </div>

    <!-- Endereço -->
    <div class="form-group">
        <label for="endereco">Endereço</label>
        <input type="text" id="endereco" name="endereco" placeholder="Endereço" value="{{ endereco or '' }}" required>
    </div>

    <!-- Estado -->
    <div class="form-group">
        <label for="estado">Estado</label>
        <select id="estado" name="estado" required>
            <option value="">Selecione um estado</option>
        </select>
    </div>

    <!-- Cidade -->
    <div class="form-group">
        <label for="cidade">Cidade</label>
        <select id="cidade" name="cidade" required>
            <option value="">Selecione uma cidade</option>
        </select>
    </div>

    <!-- Tamanho da Fazenda -->
    <div class="form-group">
        <label for="tamanho_fazenda">Tamanho da Fazenda (hectares)</label>
        <input type="number" id="tamanho_fazenda" name="tamanho_fazenda" placeholder="Tamanho da Fazenda" value="{{ tamanho_fazenda or '' }}" min="0" step="0.1" required>
    </div>

    <!-- Tipo de Cultivo -->
    <div class="form-group">
        <label for="tipo_cultivo">Tipo de Cultivo</label>
        <input type="text" id="tipo_cultivo" name="tipo_cultivo" placeholder="Tipo de Cultivo" value="{{ tipo_cultivo or '' }}" required>
    </div>

    <!-- Sistema de Irrigação -->
    <div class="form-group">
        <label for="sistema_irrigacao">Sistema de Irrigação</label>
        <input type="text" id="sistema_irrigacao" name="sistema_irrigacao" placeholder="Sistema de Irrigação" value="{{ sistema_irrigacao or '' }}" required>
    </div>

    <!-- Número de Funcionários -->
    <div class="form-group">
        <label for="numero_funcionarios">Número de Funcionários</label>
        <input type="number" id="numero_funcionarios" name="numero_funcionarios" placeholder="Número de Funcionários" value="{{ numero_funcionarios or '' }}" min="0" required>
    </div>

    <!-- Histórico de Uso de Pesticidas -->
    <div class="form-group">
        <label for="historico_pesticidas">Histórico de Uso de Pesticidas</label>
        <textarea id="historico_pesticidas" name="historico_pesticidas" placeholder="Descreva o histórico de uso de pesticidas" rows="4">{{ historico_pesticidas or '' }}</textarea>
    </div>

    <!-- Observações Adicionais -->
    <div class="form-group">
        <label for="observacoes">Observações Adicionais</label>
        <textarea id="observacoes" name="observacoes" placeholder="Observações Adicionais" rows="4">{{ observacoes or '' }}</textarea>
    </div>

    <!-- Botão Salvar -->
    <div class="form-actions">
        <button type="submit" class="button-save">Salvar</button>
    </div>
</form>


<script>
    document.addEventListener("DOMContentLoaded", function () {
        const estadoSelect = document.getElementById('estado');
        const cidadeSelect = document.getElementById('cidade');

        // Função para carregar estados
        function carregarEstados() {
            fetch('https://servicodados.ibge.gov.br/api/v1/localidades/estados')
                .then(response => response.json())
                .then(estados => {
                    estados.forEach(estado => {
                        let option = document.createElement('option');
                        option.value = estado.sigla;
                        option.textContent = estado.nome;
                        estadoSelect.appendChild(option);
                    });
                })
                .catch(error => console.error('Erro ao carregar estados:', error));
        }

        // Função para carregar cidades com base no estado selecionado
        function carregarCidades(estadoSigla) {
            fetch(`https://servicodados.ibge.gov.br/api/v1/localidades/estados/${estadoSigla}/municipios`)
                .then(response => response.json())
                .then(cidades => {
                    cidadeSelect.innerHTML = '<option value="">Selecione uma cidade</option>';
                    cidades.forEach(cidade => {
                        let option = document.createElement('option');
                        option.value = cidade.nome;
                        option.textContent = cidade.nome;
                        cidadeSelect.appendChild(option);
                    });
                })
                .catch(error => console.error('Erro ao carregar cidades:', error));
        }

        // Carregar os estados ao carregar a página
        carregarEstados();

        // Atualizar cidades quando o estado for selecionado
        estadoSelect.addEventListener('change', function () {
            const estadoSigla = this.value;
            if (estadoSigla) {
                carregarCidades(estadoSigla);
            } else {
                cidadeSelect.innerHTML = '<option value="">Selecione uma cidade</option>';
            }
        });
    });
</script>


{% endblock %}
